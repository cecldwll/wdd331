@use "../global-styles/theme" as theme;

// --------------------------
// Glitchy horizontal lines overlay
// --------------------------

// Lines on the page using pseudo-elements
body::before,
body::after {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9999;
  mix-blend-mode: screen; // try 'normal' if you need better visibility for debugging
}

// Cyan lines
body::before {
  background: repeating-linear-gradient(
    to bottom,
    transparent 0px,
    transparent 3px,
    theme.color(variant-1) 3px,
    theme.color(variant-1) 4px,
    transparent 4px
  );
  opacity: 0.06; // subtle but visible
  animation: glitchLines 6s infinite steps(2, end);
}

// Magenta lines
body::after {
  background: repeating-linear-gradient(
    to bottom,
    transparent 0px,
    transparent 2px,
    theme.color(variant-4) 2px,
    theme.color(variant-4) 3px,
    transparent 3px
  );
  opacity: 0.06;
  animation: glitchLinesAlt 7s infinite steps(3, end);
}

// --------------------------
// Keyframes for glitchy vertical offset
// --------------------------
@keyframes glitchLines {
  0%   { transform: translateY(0px); }
  10%  { transform: translateY(-2px); }
  20%  { transform: translateY(1px); }
  30%  { transform: translateY(-3px); }
  40%  { transform: translateY(0px); }
  50%  { transform: translateY(2px); }
  60%  { transform: translateY(-1px); }
  70%  { transform: translateY(0px); }
  80%  { transform: translateY(-2px); }
  90%  { transform: translateY(1px); }
  100% { transform: translateY(0px); }
}

@keyframes glitchLinesAlt {
  0%   { transform: translateY(0px); }
  15%  { transform: translateY(1px); }
  25%  { transform: translateY(-2px); }
  35%  { transform: translateY(2px); }
  45%  { transform: translateY(-1px); }
  55%  { transform: translateY(0px); }
  65%  { transform: translateY(3px); }
  75%  { transform: translateY(-2px); }
  85%  { transform: translateY(1px); }
  95%  { transform: translateY(0px); }
  100% { transform: translateY(0px); }
}

// --------------------------
// Glitch effect on h2 hover
// --------------------------
section h2 {
  display: inline-block;
  position: relative;

  // Default styling
  color: theme.color(text);

  &:hover {
    text-shadow: 0.025em 0 0 theme.color(variant-4),
                 -0.025em -0.015em 0 theme.color(variant-1),
                 -0.015em 0.025em 0 theme.color(variant-4);

    animation: glitchTextColors 850ms linear infinite;

    &::before,
    &::after {
      content: attr(data-text); // optional if you have a data-text attribute, else fallback
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      overflow: hidden;
    }

    &::before {
      clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
      transform: translate(-0.05em, -0.025em);
      animation: brokenTextOne 750ms linear infinite;
    }

    &::after {
      clip-path: polygon(0 80%, 100% 20%, 100% 100%, 0 100%);
      transform: translate(0.05em, 0.025em);
      animation: brokenTextTwo 1000ms linear infinite;
    }
  }
}

// --------------------------
// Keyframes (reuse from h1 glitch)
@keyframes glitchTextColors {
  0% {
    text-shadow: 0.05em 0 0 theme.color(variant-4),
                 -0.05em -0.025em 0 theme.color(variant-1),
                 -0.025em 0.05em 0 theme.color(variant-4);
  }
  14% {
    text-shadow: 0.05em 0 0 theme.color(variant-4),
                 -0.05em -0.025em 0 theme.color(variant-1),
                 -0.025em 0.05em 0 theme.color(variant-4);
  }
  15% {
    text-shadow: -0.05em -0.025 0 theme.color(variant-4),
                 0.025em 0.025em 0 theme.color(variant-1),
                 -0.05em -0.05em 0 theme.color(variant-4);
  }
  49% {
    text-shadow: -0.05em -0.025 0 theme.color(variant-4),
                 0.025em 0.025em 0 theme.color(variant-1),
                 -0.05em -0.05em 0 theme.color(variant-4);
  }
  50% {
    text-shadow: 0.025em 0.05em 0 theme.color(variant-4),
                 0.05em 0 0 theme.color(variant-1),
                 0 -0.05em 0 theme.color(variant-4);
  }
  99% {
    text-shadow: 0.025em 0.05em 0 theme.color(variant-4),
                 0.05em 0 0 theme.color(variant-1),
                 0 -0.05em 0 theme.color(variant-4);
  }
  100% {
    text-shadow: -0.025em 0 0 theme.color(variant-4),
                 -0.025em -0.025em 0 theme.color(variant-1),
                 -0.025em -0.05em 0 theme.color(variant-4);
  }
}

@keyframes brokenTextOne {
  0%, 65% { transform: translate(0, 0); }
  70%, 80% { transform: translate(-0.05em, -0.025em); }
  85%, 100% { transform: translate(0, 0); }
}

@keyframes brokenTextTwo {
  0%, 15% { transform: translate(0, 0); }
  20%, 30% { transform: translate(0.05em, -0.025em); }
  35%, 100% { transform: translate(0, 0); }
}
